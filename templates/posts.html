<!DOCTYPE html>
< lang="ru">
<head>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/post.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/home.css') }}">

    
    <meta charset="UTF-8">
    <title>–õ–µ–Ω—Ç–∞ –∑–∞–ø–∏—Å–µ–π</title>
    <!-- <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .post { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; position: relative; cursor: pointer; }
        .comment-count { position: absolute; bottom: 10px; right: 10px; color: gray; font-size: 12px; }
        .content, .comments, .add-comment { display: none; margin-top: 10px; }
        .pagination { margin-top: 20px; }
        .pagination a { margin: 0 5px; text-decoration: none; }
    </style> -->
</head>
    <script src="{{ url_for('static', filename='scripts/profileMenu.js') }}" defer></script>
    <script type="module" src="{{ url_for('static', filename='scripts/posts.js') }}" defer></script>
    <div id="top-menu-container">
        <a href="{{ url_for('open_builds') }}" class="top-menu-button">–°–±–æ—Ä–∫–∏</a>
        <a href="{{ url_for('open_wishlists') }}"  class="top-menu-button">–í–∏—à–ª–∏—Å—Ç</a>
        <a href="/main_post_page" class="top-menu-button">–ü–æ—Å—Ç—ã</a>
        <div id="profile-container">
            <a id="profile-icon">
                <img src="{{ url_for('static', filename='images/profile_icon.png') }}" alt="–ü—Ä–æ—Ñ–∏–ª—å" onclick="toggle_menu()">
            </a>
            <div id="profile-menu">
                <a class="profile-menu-button"> {{ user_data['username'] }}</a>
                <a href="/profile" class="profile-menu-button">–ü—Ä–æ—Ñ–∏–ª—å</a>
                <a href="{{ url_for('open_settings_page') }}" class="profile-menu-button">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
                <a href="{{ url_for('logout') }}" class="profile-menu-button">–í—ã—Ö–æ–¥</a>
            </div>
        </div>
        
    </div>
    <div id="create-post-menu" class="hidden"> 
        <div id="post-title-container">
            <input id="post-title-input" name="post-title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞">
            <textarea id="post-text-area" rows="4" style="resize: none;"></textarea>
        </div>
        <button id="post-select-build-button" class="post-build-button">–í—ã–±—Ä–∞—Ç—å —Å–±–æ—Ä–∫—É</button>
        <div id="builds-menu" class="hidden">
            <ul id="builds-list"></ul>
        </div>
        <div id="post-build-container">
            <button id="publish-post" class="base-button">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
        </div>
    </div>
    <div id="posts-container">
        {% for post in posts %}
        <div class="post" data-id="{{ post._id }}">
            <div class="post-title-container">
                <a class="post-title">{{ post.title }}</a>
                {% if post.can_delete %}
                    <div class="post-controls">
                        <button class="delete-post">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                {% endif %}
            </div>
            
            <div class="post-data hidden">
                <div class="post-description">
                    {% if post.content %}
                        <div class="post-contnent">{{ post.content|safe }}</div>
                    {% endif %}
                </div>
                <div class="post-build-info">
                    {% if post.setup %}
                        <div class="content">{{ post.setup|safe }}</div>
                    {% endif %}
                </div>
                <div class="border-hor"></div>
                <div class="post-comments-container hidden">
                    <div class="comments">
                        {% for comment in post.comments %}
                            <div class="comment-box" data-id="{{ comment._id }}">
                                <div class="comment-header">
                                    <span class="comment-user">{{ comment.user }}</span>
                                    <span class="comment-date">{{ comment.created_at.strftime('%d.%m.%Y %H:%M') }}</span>
                                    {% if comment.can_delete %}
                                        <button class="delete-comment">üóëÔ∏è</button>
                                    {% endif %}
                                </div>
                                <div class="comment-text">{{ comment.text }}</div>
                            </div>
                        {% endfor %}
                    </div>
                    <div class="post-bottom-container">
                        <div class="add-comment">
                            <input class="comment-input" type="text" placeholder="–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" />
                            <button class="base-button">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        </div>
                        <div class="comment-count">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤: {{ post.comments|length }}</div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
        <div>
            <button id="create-post-button" class="base-button">–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</button>
        </div>
        <div class="pagination">
            {% for i in range(1, total_pages + 1) %}
                {% if i == current_page %}
                    <strong>{{ i }}</strong>
                {% else %}
                    <a href="/main_post_page?page={{ i }}">{{ i }}</a>
                {% endif %}
            {% endfor %}
        </div>

        <script src="{{ url_for('static', filename='scripts/posts.js') }}"></script>
    </div>
</body>
</html>
